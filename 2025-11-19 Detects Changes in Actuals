' === Step 3: Pull new actuals from CurrActuals not in PrevActuals ===
Dim wsPrevAct As Worksheet
Dim lastRowPrevAct As Long
Dim prevActDict As Object
Dim currActKey As String

' Set PrevActuals sheet
Set wsPrevAct = ThisWorkbook.Sheets("PrevActuals")
lastRowPrevAct = wsPrevAct.Cells(wsPrevAct.Rows.Count, "T").End(xlUp).Row

' Build dictionary of existing OppID + RevStream in PrevActuals
Set prevActDict = CreateObject("Scripting.Dictionary")
For i = 2 To lastRowPrevAct
    currActKey = Trim(wsPrevAct.Cells(i, "T").Value) & "_" & Trim(wsPrevAct.Cells(i, "AI").Value)
    If Not prevActDict.Exists(currActKey) Then
        prevActDict(currActKey) = 1
    End If
Next i

' Loop through CurrActuals to detect new OppID + RevStream
For i = 2 To lastRowCurrAct
    currActKey = Trim(wsCurrAct.Cells(i, "T").Value) & "_" & Trim(wsCurrAct.Cells(i, "AI").Value)
    
    ' Only bring in if key does NOT exist in PrevActuals
    If Not prevActDict.Exists(currActKey) Then
        ' Copy row from CurrActuals to Report
        wsReport.Cells(reportRow, 1).Resize(1, 60).Value = wsCurrAct.Cells(i, "T").Resize(1, 60).Value
        
        ' Set reason/source
        wsReport.Cells(reportRow, reasonCol).Value = "New Actual"
        wsReport.Cells(reportRow, reasonCol + 1).Value = "CurrActuals"
        
        reportRow = reportRow + 1
    End If
Next i
